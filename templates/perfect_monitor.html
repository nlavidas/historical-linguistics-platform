<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš€ Perfect AI Monitoring Dashboard - Ultimate Production System</title>

    <!-- Core Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>

    <!-- UI Framework -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Custom Styles -->
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger-gradient: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            min-height: 100vh;
            font-family: 'Inter', 'Segoe UI', sans-serif;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .metric-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .metric-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .ai-model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }

        .model-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .model-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        .model-card.available {
            border-color: #10b981;
        }

        .model-card.unavailable {
            border-color: #ef4444;
            opacity: 0.7;
        }

        .pulse-ring {
            animation: pulse-ring 2s infinite;
        }

        @keyframes pulse-ring {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .status-online { background: #10b981; box-shadow: 0 0 10px #10b981; }
        .status-offline { background: #ef4444; }
        .status-warning { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .terminal {
            background: #0f0f23;
            color: #e2e8f0;
            font-family: 'Fira Code', 'Courier New', monospace;
            border-radius: 8px;
            padding: 1rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.25rem;
            border-radius: 4px;
            font-size: 0.875rem;
        }

        .log-info { border-left: 3px solid #3b82f6; }
        .log-warning { border-left: 3px solid #f59e0b; }
        .log-error { border-left: 3px solid #ef4444; }
        .log-success { border-left: 3px solid #10b981; }

        .control-button {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .control-button:active {
            transform: translateY(0);
        }

        .alert-banner {
            background: var(--danger-gradient);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .cyber-grid {
            background-image:
                linear-gradient(rgba(102, 126, 234, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(102, 126, 234, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="cyber-grid">
    <!-- Header -->
    <header class="glass-card mx-6 mt-6 p-6">
        <div class="flex justify-between items-center mb-4">
            <div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 bg-clip-text text-transparent">
                    <i class="fas fa-rocket mr-2"></i>Perfect AI Monitoring Dashboard
                </h1>
                <p class="text-gray-400 mt-1">Ultimate Production System - All Community-Driven AIs Integrated</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center">
                    <div class="status-indicator status-online pulse-ring"></div>
                    <span class="text-green-400 font-semibold">SYSTEM ONLINE</span>
                </div>
                <div class="text-sm text-gray-400">
                    <i class="fas fa-clock mr-1"></i>
                    <span id="current-time">--:--:--</span>
                </div>
            </div>
        </div>

        <!-- Quick Stats Bar -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="text-center">
                <div class="text-2xl font-bold text-blue-400" id="total-models">--</div>
                <div class="text-sm text-gray-400">AI Models</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-green-400" id="active-models">--</div>
                <div class="text-sm text-gray-400">Active</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-purple-400" id="total-requests">--</div>
                <div class="text-sm text-gray-400">Requests</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-yellow-400" id="uptime">--</div>
                <div class="text-sm text-gray-400">Uptime</div>
            </div>
        </div>
    </header>

    <!-- Alerts Container -->
    <div id="alerts-container" class="mx-6">
        <!-- Dynamic alerts will appear here -->
    </div>

    <!-- Main Dashboard -->
    <main class="mx-6 mb-6">
        <!-- Tab Navigation -->
        <div class="glass-card p-4 mb-6">
            <div class="flex space-x-1">
                <button class="tab-button active" onclick="switchTab('overview')">
                    <i class="fas fa-tachometer-alt mr-2"></i>Overview
                </button>
                <button class="tab-button" onclick="switchTab('ai-models')">
                    <i class="fas fa-brain mr-2"></i>AI Models
                </button>
                <button class="tab-button" onclick="switchTab('system')">
                    <i class="fas fa-server mr-2"></i>System
                </button>
                <button class="tab-button" onclick="switchTab('automation')">
                    <i class="fas fa-cogs mr-2"></i>Automation
                </button>
                <button class="tab-button" onclick="switchTab('logs')">
                    <i class="fas fa-terminal mr-2"></i>Logs
                </button>
            </div>
        </div>

        <!-- Tab Content -->
        <div id="overview" class="tab-content active">
            <!-- System Metrics Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <!-- CPU Usage -->
                <div class="metric-card glass-card p-6" onclick="showMetricDetail('cpu')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-blue-400">CPU Usage</h3>
                        <i class="fas fa-microchip text-2xl text-blue-400"></i>
                    </div>
                    <div class="text-3xl font-bold text-white mb-2" id="cpu-usage">--%</div>
                    <div class="w-full bg-gray-700 rounded-full h-2 mb-2">
                        <div class="bg-blue-500 h-2 rounded-full transition-all duration-500" id="cpu-bar" style="width: 0%"></div>
                    </div>
                    <div class="text-sm text-gray-400">
                        <span id="cpu-cores">--</span> cores
                    </div>
                </div>

                <!-- Memory Usage -->
                <div class="metric-card glass-card p-6" onclick="showMetricDetail('memory')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-green-400">Memory</h3>
                        <i class="fas fa-memory text-2xl text-green-400"></i>
                    </div>
                    <div class="text-3xl font-bold text-white mb-2" id="memory-usage">--%</div>
                    <div class="text-sm text-gray-400 mb-2" id="memory-details">-- / -- GB</div>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div class="bg-green-500 h-2 rounded-full transition-all duration-500" id="memory-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Disk Usage -->
                <div class="metric-card glass-card p-6" onclick="showMetricDetail('disk')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-purple-400">Disk</h3>
                        <i class="fas fa-hdd text-2xl text-purple-400"></i>
                    </div>
                    <div class="text-3xl font-bold text-white mb-2" id="disk-usage">--%</div>
                    <div class="text-sm text-gray-400 mb-2" id="disk-details">-- / -- GB</div>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" id="disk-bar" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Network -->
                <div class="metric-card glass-card p-6" onclick="showMetricDetail('network')">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-yellow-400">Network</h3>
                        <i class="fas fa-network-wired text-2xl text-yellow-400"></i>
                    </div>
                    <div class="text-lg font-bold text-white mb-1" id="network-up">-- MB/s</div>
                    <div class="text-sm text-gray-400 mb-2">Upload</div>
                    <div class="text-lg font-bold text-white mb-1" id="network-down">-- MB/s</div>
                    <div class="text-sm text-gray-400">Download</div>
                </div>
            </div>

            <!-- Performance Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="glass-card p-6">
                    <h3 class="text-xl font-semibold mb-4 text-white">System Performance</h3>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>

                <div class="glass-card p-6">
                    <h3 class="text-xl font-semibold mb-4 text-white">AI Usage Distribution</h3>
                    <div class="chart-container">
                        <canvas id="aiUsageChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="glass-card p-6">
                <h3 class="text-xl font-semibold mb-4 text-white">Quick Actions</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button class="control-button" onclick="runAutomation('lightside')">
                        <i class="fas fa-brain mr-2"></i>Train LightSide
                    </button>
                    <button class="control-button" onclick="runAutomation('transformer')">
                        <i class="fas fa-cogs mr-2"></i>Run Annotations
                    </button>
                    <button class="control-button" onclick="runAutomation('export')">
                        <i class="fas fa-upload mr-2"></i>Export to HF
                    </button>
                </div>
            </div>
        </div>

        <!-- AI Models Tab -->
        <div id="ai-models" class="tab-content">
            <div class="glass-card p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">AI Models Status</h2>
                    <div class="flex space-x-2">
                        <button class="control-button" onclick="benchmarkModels()">
                            <i class="fas fa-chart-line mr-2"></i>Benchmark
                        </button>
                        <button class="control-button" onclick="refreshModels()">
                            <i class="fas fa-sync mr-2"></i>Refresh
                        </button>
                    </div>
                </div>

                <div id="ai-models-grid" class="ai-model-grid">
                    <!-- AI models will be populated here -->
                </div>
            </div>
        </div>

        <!-- System Tab -->
        <div id="system" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="glass-card p-6">
                    <h3 class="text-xl font-semibold mb-4 text-white">System Information</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-400">Operating System:</span>
                            <span class="text-white" id="os-info">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Python Version:</span>
                            <span class="text-white" id="python-version">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">GPU Available:</span>
                            <span class="text-white" id="gpu-available">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Database:</span>
                            <span class="text-white" id="db-status">--</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-400">Redis:</span>
                            <span class="text-white" id="redis-status">--</span>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-6">
                    <h3 class="text-xl font-semibold mb-4 text-white">Resource History</h3>
                    <div class="chart-container">
                        <canvas id="resourceHistoryChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Automation Tab -->
        <div id="automation" class="tab-content">
            <div class="glass-card p-6">
                <h3 class="text-xl font-semibold mb-4 text-white">Automation Jobs</h3>
                <div id="automation-jobs" class="space-y-4 max-h-96 overflow-y-auto">
                    <!-- Automation jobs will be populated here -->
                </div>
            </div>
        </div>

        <!-- Logs Tab -->
        <div id="logs" class="tab-content">
            <div class="glass-card p-6">
                <h3 class="text-xl font-semibold mb-4 text-white">System Logs</h3>
                <div class="terminal" id="logs-container">
                    <!-- Logs will be populated here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mx-6 mb-6 glass-card p-4 text-center text-gray-400">
        <p>Perfect AI Monitoring Dashboard v4.0.0 | Powered by All Community-Driven AIs</p>
        <p class="text-sm mt-1">NKUA Historical Linguistics Platform - Hellenic Foundation for Research and Innovation</p>
    </footer>

    <script>
        // Global state
        let systemChart, aiUsageChart, resourceHistoryChart;
        let currentTab = 'overview';
        let updateInterval;

        // Initialize charts
        function initCharts() {
            // Performance Chart
            const perfCtx = document.getElementById('performanceChart').getContext('2d');
            systemChart = new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'CPU %',
                        data: [],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Memory %',
                        data: [],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Disk %',
                        data: [],
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100 },
                        x: { display: false }
                    },
                    plugins: { legend: { labels: { color: 'white' } } }
                }
            });

            // AI Usage Chart
            const aiCtx = document.getElementById('aiUsageChart').getContext('2d');
            aiUsageChart = new Chart(aiCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Stanza', 'spaCy', 'Transformers', 'Ollama', 'LightSide', 'Others'],
                    datasets: [{
                        data: [25, 20, 18, 15, 12, 10],
                        backgroundColor: [
                            '#3b82f6', '#10b981', '#8b5cf6', '#f59e0b',
                            '#ef4444', '#6b7280'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: 'white' },
                            position: 'bottom'
                        }
                    }
                }
            });

            // Resource History Chart
            const resourceCtx = document.getElementById('resourceHistoryChart').getContext('2d');
            resourceHistoryChart = new Chart(resourceCtx, {
                type: 'bar',
                data: {
                    labels: ['1h ago', '2h ago', '3h ago', '4h ago', '5h ago', '6h ago'],
                    datasets: [{
                        label: 'CPU Average',
                        data: [45, 52, 38, 65, 42, 48],
                        backgroundColor: '#3b82f6'
                    }, {
                        label: 'Memory Average',
                        data: [62, 58, 71, 68, 55, 63],
                        backgroundColor: '#10b981'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 100 }
                    },
                    plugins: { legend: { labels: { color: 'white' } } }
                }
            });
        }

        // Update system metrics
        async function updateSystemMetrics() {
            try {
                const response = await fetch('/api/monitor/system');
                const data = await response.json();

                // Update metrics
                document.getElementById('cpu-usage').textContent = data.cpu_usage.toFixed(1) + '%';
                document.getElementById('cpu-bar').style.width = data.cpu_usage + '%';

                document.getElementById('memory-usage').textContent = data.memory.percentage.toFixed(1) + '%';
                document.getElementById('memory-details').textContent =
                    `${(data.memory.used / (1024**3)).toFixed(1)} / ${(data.memory.total / (1024**3)).toFixed(1)} GB`;
                document.getElementById('memory-bar').style.width = data.memory.percentage + '%';

                document.getElementById('disk-usage').textContent = data.disk.percentage.toFixed(1) + '%';
                document.getElementById('disk-details').textContent =
                    `${(data.disk.used / (1024**3)).toFixed(1)} / ${(data.disk.total / (1024**3)).toFixed(1)} GB`;
                document.getElementById('disk-bar').style.width = data.disk.percentage + '%';

                // Update charts
                const now = new Date().toLocaleTimeString();
                if (systemChart.data.labels.length > 20) {
                    systemChart.data.labels.shift();
                    systemChart.data.datasets.forEach(ds => ds.data.shift());
                }
                systemChart.data.labels.push(now);
                systemChart.data.datasets[0].data.push(data.cpu_usage);
                systemChart.data.datasets[1].data.push(data.memory.percentage);
                systemChart.data.datasets[2].data.push(data.disk.percentage);
                systemChart.update();

            } catch (error) {
                console.error('Failed to update system metrics:', error);
            }
        }

        // Update AI models
        async function updateAIModels() {
            try {
                const response = await fetch('/api/monitor/ai');
                const data = await response.json();

                document.getElementById('total-models').textContent = data.total_models;
                document.getElementById('active-models').textContent = data.available_models;

                const grid = document.getElementById('ai-models-grid');
                grid.innerHTML = '';

                Object.entries(data.models).forEach(([name, model]) => {
                    const card = document.createElement('div');
                    card.className = `model-card ${model.available ? 'available' : 'unavailable'} fade-in`;

                    card.innerHTML = `
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-white">${model.name}</h4>
                            <span class="px-2 py-1 rounded text-xs ${model.available ? 'bg-green-600' : 'bg-red-600'}">
                                ${model.available ? 'Available' : 'Unavailable'}
                            </span>
                        </div>
                        <p class="text-gray-400 text-sm mb-2">${model.description}</p>
                        <div class="text-xs text-gray-500">
                            <div>Framework: ${model.framework}</div>
                            <div>Task: ${model.task_type}</div>
                            <div>Languages: ${model.languages.join(', ')}</div>
                            ${model.gpu_support ? '<div class="text-green-400">GPU Support âœ“</div>' : ''}
                        </div>
                    `;

                    grid.appendChild(card);
                });

            } catch (error) {
                console.error('Failed to update AI models:', error);
            }
        }

        // Run automation
        async function runAutomation(type) {
            try {
                const response = await fetch(`/api/automation/${type}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + localStorage.getItem('token'),
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    showAlert('Automation job started successfully!', 'success');
                } else {
                    showAlert('Failed to start automation job', 'error');
                }
            } catch (error) {
                showAlert('Network error: ' + error.message, 'error');
            }
        }

        // Show alerts
        function showAlert(message, type = 'info') {
            const container = document.getElementById('alerts-container');
            const alert = document.createElement('div');
            alert.className = 'alert-banner fade-in';
            alert.innerHTML = `
                <i class="fas fa-exclamation-triangle mr-2"></i>
                ${message}
                <button onclick="this.parentElement.remove()" class="ml-auto">
                    <i class="fas fa-times"></i>
                </button>
            `;
            container.appendChild(alert);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (alert.parentElement) {
                    alert.remove();
                }
            }, 5000);
        }

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            currentTab = tabName;
        }

        // Update current time
        function updateTime() {
            document.getElementById('current-time').textContent =
                new Date().toLocaleTimeString();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            updateTime();
            updateSystemMetrics();
            updateAIModels();

            // Update every 5 seconds
            updateInterval = setInterval(() => {
                updateSystemMetrics();
                updateTime();
            }, 5000);

            // Update AI models every 30 seconds
            setInterval(updateAIModels, 30000);
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });
    </script>
</body>
</html>
